<div
  class="sky-file-attachment-wrapper"
>
  <div
    class="sky-file-attachment-label-wrapper"
    [attr.aria-required]="(required) ? true : null"
    [attr.id]="labelElementId"
    [ngClass]="{ 'sky-control-label-required': required && hasLabelComponent }"
  >
    <ng-container *ngTemplateOutlet="labelContent"
    ></ng-container>
  </div>
  <div
    class="sky-file-attachment-upload sky-file-attachment sky-file-attachment-target"
    [ngClass]="{ 'sky-file-attachment-accept': acceptedOver, 'sky-file-attachment-reject': rejectedOver }"
    (dragenter)="fileDragEnter($event)"
    (dragover)="fileDragOver($event)"
    (dragleave)="fileDragLeave($event)"
    (drop)="fileDrop($event)"
  >
    <div
      aria-hidden="true"
      class="sky-file-attachment-drop-description"
      role="tooltip"
      [attr.id]="fileDropDescriptionElementId"
    >
      {{ 'skyux_file_attachment_file_upload_drag_or_click' | skyLibResources }}
    </div>
    <input
      hidden
      tabindex="-1"
      type="file"
      [attr.accept]="acceptedTypes || null"
      [disabled]="disabled"
      [required]="required"
      (change)="fileChangeEvent($event)"
      #fileInput
    >
    <ng-template #chooseFile>
      <button
        class="sky-file-attachment-btn sky-btn sky-btn-default"
        type="button"
        [attr.aria-describedby]="fileDropDescriptionElementId"
        [disabled]="disabled"
        (click)="onDropClicked()"
      >
        <sky-icon
          icon="folder-open-o"
        ></sky-icon>
        {{ value ?
          ('skyux_file_attachment_button_label_replace_file' | skyLibResources) :
          ('skyux_file_attachment_button_label_choose_file' | skyLibResources)
        }}
      </button>
    </ng-template>
    <ng-template #linkedFile>
      <a
        (click)="emitClick()"
      >
        {{ getFileName() }}
      </a>
    </ng-template>
    <ng-template #noFile>
      <span class="sky-file-attachment-none sky-deemphasized">
        {{ 'skyux_file_attachment_label_no_file_chosen' | skyLibResources }}
      </span>
    </ng-template>
    <ng-template [skyThemeIf]="'modern'">
      <ng-template [ngIf]="!value">
        <ng-container *ngTemplateOutlet="chooseFile"></ng-container>
      </ng-template>
      <sky-icon *ngIf="value && !isImage()"
        class="sky-file-attachment-icon sky-deemphasized"
        icon="file-o"
        size="2x"
      ></sky-icon>
      <span class="sky-file-attachment-name">
        <ng-template *ngIf="value; then linkedFile"></ng-template>
      </span>
    </ng-template>
    <ng-template [skyThemeIf]="'default'">
      <ng-container *ngTemplateOutlet="chooseFile"></ng-container>
      <span class="sky-file-attachment-name">
        <ng-template *ngIf="value; then linkedFile else noFile"></ng-template>
      </span>
    </ng-template>
    <button *ngIf="value"
      class="sky-btn sky-btn-borderless sky-file-attachment-delete"
      type="button"
      [attr.aria-label]="'skyux_file_attachment_file_item_delete' | skyLibResources"
      [disabled]="disabled"
      [skyThemeClass]="{
        'sky-btn-icon-borderless': 'modern'
      }"
      (click)="deleteFileAttachment()"
    >
      <sky-icon
        icon="trash-o"
        size="md"
      >
      </sky-icon>
    </button>
  </div>

  <img *ngIf="value && isImage()"
    class="sky-file-attachment-preview-img"
    [alt]="'skyux_file_attachment_file_upload_image_preview_alt_text' | skyLibResources"
    [src]="value.url"
  />
</div>

<ng-template
  #labelContent
>
    <ng-content
      select="sky-file-attachment-label"
    ></ng-content>
</ng-template>
